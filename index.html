<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="icon" type="image/png" href="/favicon.png">
    <!--PROD
    <link type="text/css" rel="stylesheet" href="dist/bundle.css" />
    -->

    <!--DEV,PROD -->
    <!--
    - See [#18](https://github.com/akauppi/GroundLevel-es6-firebase-web/issues/18), why this is needed.
    -
    - Firebase UI
    -   - latest versions -> https://github.com/firebase/firebaseui-web/releases
    -
    - This is only needed in 'SignIn.vue'. Ideally, it would merely 'import' it, but that doesn't work until Firebase
    - can be read the way it wants ('import * as firebase from ...'). See 'src/init.dev-vite.js'.
    -
    - NOTE: It's not unlikely that one day we'd read the source of the Firebase UI project and implement the parts
    -     needed (we don't use/need all authentication flows) as a Vue-specific component. This a) does not seem to
    -     be as great quality as other tools we use and b) we're not getting it from npm.
    -- >
    <script defer src="https://www.gstatic.com/firebasejs/ui/4.5.1/firebase-ui-auth.js"></script>
    <link type="text/css" rel="stylesheet" href="https://www.gstatic.com/firebasejs/ui/4.5.1/firebase-ui-auth.css" />
    < !-- -->

    <!--PROD
    ${PRELOADS}
    -->

    <!--PROD
    <script type="module">
      import { init } from './dist/main.#.js'

      // On Firebase hosting, we can get the configuration from the server:
      //
      // <<
      //    if (typeof firebase === 'undefined') throw new Error('hosting/init-error: Firebase SDK not detected. You must include it before /__/firebase/init.js');
      //    var firebaseConfig = {
      //      "projectId": "vue-rollup-example",
      //      "appId": ...,
      //      ...
      //
      //    };
      //    if (firebaseConfig) {
      //      firebase.initializeApp(firebaseConfig);
      //    }
      // <<
      //
      // The values are NOT secrets. You can safely place a config right here, as on object (faster loading). For
      // ease of code sharing, we prefer fetching it.
      //
      fetch('/__/firebase/init.js')
        .then(resp => {    // returns JavaScript; parse away the program parts
          if (!resp.ok) {
            console.fatal("Unable to read Firebase config:", resp);
            throw Error("Unable to read Firebase config (see console)");
          }
          resp.text().then( s => {
            const s2 = s.replace(/^[\s\S]+ firebaseConfig = ({[\s\S]+\n});\s+if [\s\S]+$/gm, "$1");
            init( JSON.parse(s2) );
          });
        });
    </script>
    -->
    <!--DEV -->
    <script type="module">
      import { __ } from './.__.js';
      import { init } from './src/init.dev-vite.js'
      init(__);
    </script>
    <!-- -->
  </head>

  <body>
    <div id="app"></div>
  </body>
</html>
