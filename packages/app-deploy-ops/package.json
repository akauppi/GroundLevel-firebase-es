{
  "name": "@local/app-deploy-ops",
  "description": "Sample front end (deployment & operations)",
  "license": "MIT",
  "private": true,
  "type": "module",
  "engines": {
    "node": ">=14.3"
  },
  "scripts": {
    "test": ">&2 echo \"No tests here. Tests are run in development projects (../app and ../backend).\"; false",
    "lint": "eslint src",
    "build": "npm run --silent build:roll",
    "serve": "npm run --silent serve:roll",
    "watch": "npm run --silent watch:roll",
    "deploy": "npm run --silent deploy:roll",
    "  -": "",
    "watch:roll": "concurrently -k -n roll,host \"npm run --silent _watch_roll_rollup\" \"npm run --silent _watch_roll_host\"",
    "_watch_roll_rollup": "rollup -c roll/rollup.config.js -w",
    "_watch_roll_host": "npm run --silent serve:roll",
    "  - ": "",
    "build:roll": "npm run --silent _prepRollOut && rollup -c roll/rollup.config.js",
    "_prepRollOut": "(cd roll/out && ln -fs ../../node_modules/@local/app/vitebox/public/* .) && npm run --silent _prepRollOut2",
    "_prepRollOut2": "(cd roll/out && ln -fs ../../node_modules/@local/app/vitebox/dist/*.css .) && npm run --silent _prepRollOut3",
    "_prepRollOut3": "find roll/out \\( ! -iname \".gitkeep\" \\) -type f -delete",
    "  - --": "",
    "serve:roll": "firebase serve --config firebase.roll.json --only hosting --host 0.0.0.0 --port 3012",
    "deploy:roll": "firebase deploy --config firebase.roll.json --only hosting",
    "  - -- ": "",
    "build:vite": "vite build -c vite/vite.config.js",
    "serve:vite": "firebase serve --config firebase.vite.json --only hosting --host 0.0.0.0 --port 3012",
    "deploy:vite": "firebase deploy --config firebase.vite.json --only hosting",
    "  - ---": "",
    "preserve:roll": "(PORT=3012 npm run --silent _checkPortIsFree) && npm run --silent _prepare_roll",
    "predeploy:roll": "npm run --silent _prepare_roll",
    "_prepare_roll": "KIND=roll npm run --silent _prepare_kind",
    "prewatch:roll": "(cd roll/out && ln -fs ../../public/* .) && npm run --silent _prepRollOut",
    " - - --": "",
    "postserve:roll": "rm -f firebase.*.json",
    "postdeploy:roll": "rm -f firebase.*.json",
    "--": "",
    "preserve:vite": "(PORT=3012 npm run --silent _checkPortIsFree) && npm run --silent _checkActivation && npm run --silent _prepare_vite",
    "predeploy:vite": "npm run --silent _prepare_vite",
    "_prepare_vite": "KIND=vite npm run --silent _prepare_kind",
    "-- ": "",
    "postserve:vite": "rm -f firebase.*.json",
    "postdeploy:vite": "rm -f firebase.*.json",
    "--  ": "",
    "klean": "rm -rf roll/out/*",
    "//test": "abc",
    "-- -": "",
    "_prepare_kind": "cat firebase.json | sed \"s/\\$SERVE_PATH/$KIND\\/out/\" > firebase.$KIND.json",
    "//_checkActivation": "check-activation || ( >&2 echo \"ERROR: No active project. Please run 'npm run activate' at the repo root.\n\"; exit 8)",
    "_checkPortIsFree": "port-is-free $PORT || ( >&2 echo \"ERROR: Port '$PORT' is taken!\n\"; exit 6)"
  },
  "dependencies": {
    "@firebase/app": "file:../../node_modules/@firebase/app",
    "@firebase/functions": "file:../../node_modules/@firebase/functions",
    "@firebase/performance": "file:../../node_modules/@firebase/performance",
    "@local/app": "file:../app"
  },
  "devDependencies": {
    "@atomico/rollup-plugin-sizes": "^1.1.4",
    "@local/root": "file:../..",
    "@local/tools": "file:../../tools",
    "@rollup/plugin-alias": "^3.1.2",
    "@rollup/plugin-node-resolve": "^11.2.0",
    "@rollup/plugin-replace": "^2.4.1",
    "concurrently": "^6.0.2",
    "eslint": "file:../../node_modules/eslint",
    "first-input-delay": "^0.1.3",
    "rollup": "^2.46.0",
    "rollup-plugin-analyzer": "^4.0.0",
    "rollup-plugin-terser": "^7.0.2",
    "rollup-plugin-visualizer": "^5.0.4"
  },
  "//devDependencies": {
    "vite": "^2.1.5"
  },
  "//comments": {
    "scripts": {
      "prebuild": [
        "May be used to build '../app' but this slows down integration development so might not be the best way. tbd."
      ],
      "postbuild:roll": [
        "We _could_ use a Rollup plugin for copying (and watching) public files, but now, since only one CSS file,",
        "mere copy at each build is enough. (public/*.css)"
      ]
    },
    "dependencies": {
      "[@]rollup...": [
        "Needed for '[build|serve]:rollup'"
      ],
      "vite": [
        "Needed for '[build|serve]:vite'"
      ]
    },
    "devDependencies": {
      "@local/root": [
        "Brings binary commands of the root (in particular, 'firebase') to us."
      ]
    },
    "engines.node": [
      "'>=14.3' for 'â€”harmony-top-level-await'",
      "'>=13.2' for ES module support"
    ]
  }
}
