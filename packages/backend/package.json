{
  "name": "@local/back-end",
  "description": "Sample back-end",
  "license": "MIT",
  "private": true,
  "type": "module",
  "files": [
    "functions/*.js",
    "firestore.rules",
    "firestore.indexes.json"
  ],
  "engines": {
    "node": ">=13.2"
  },
  "scripts": {
    "test": "npm run ci",
    "ci": "npm run ci:seq",
    "  ": "",
    "ci:seq": "firebase emulators:exec --project=bunny --only firestore,functions \"npm run _ci_init && npm run --silent _ci_fns && npm run --silent _ci_rules\"",
    "_ci_init": "node test/prime-docs.js",
    "_ci_fns": "NODE_OPTIONS=--experimental-vm-modules npx jest --config test-fns/jest.config.cjs --verbose --detectOpenHandles",
    "_ci_rules": "npm run test:rules:all",
    "ci:par": "firebase emulators:exec --project=bunny --only firestore,functions \"npm run --silent _ci_par_2\"",
    "_ci_par_2": "concurrently -n test-fns,test-rules \"npm run _ci_init && npm run _ci_fns\" \"npm run _ci_rules\"",
    "  -": "",
    "start": "concurrently -n emul,init \"firebase emulators:start --project=bunny --only functions,firestore\" \"GCLOUD_PROJECT=bunny npm run _start_2\"",
    "_start_2": "wait-on http://localhost:4000 && node test/prime-docs.js",
    "test:fns:userInfo": "GCLOUD_PROJECT=bunny NODE_OPTIONS=--experimental-vm-modules npx jest --config test-fns/jest.config.cjs -f userInfo.test.js --verbose --detectOpenHandles --all",
    "test:fns:all": "GCLOUD_PROJECT=bunny NODE_OPTIONS=--experimental-vm-modules npx jest --config test-fns/jest.config.cjs --verbose --detectOpenHandles --all",
    "  --": "",
    "test:rules:invites": "NODE_OPTIONS=--experimental-vm-modules npx jest --config test-rules/jest.config.cjs -f invitesC.test.js --verbose --detectOpenHandles --all",
    "test:rules:projects": "NODE_OPTIONS=--experimental-vm-modules npx jest --config test-rules/jest.config.cjs -f projectsC/index.test.js --verbose --detectOpenHandles --all",
    "test:rules:projectsSymbols": "NODE_OPTIONS=--experimental-vm-modules npx jest --config test-rules/jest.config.cjs -f projectsC/symbolsC.test.js --verbose --detectOpenHandles --all",
    "test:rules:projectsUserInfo": "NODE_OPTIONS=--experimental-vm-modules npx jest --config test-rules/jest.config.cjs -f projectsC/userInfoC.test.js --verbose --detectOpenHandles --all",
    "test:rules:userInfo": "NODE_OPTIONS=--experimental-vm-modules npx jest --config test-rules/jest.config.cjs -f userInfoC.test.js --verbose --detectOpenHandles --all",
    "test:rules:all": "NODE_OPTIONS=--experimental-vm-modules npx jest --config test-rules/jest.config.cjs --verbose --detectOpenHandles --all",
    " -- ": "",
    "deploy": "firebase deploy --only functions,firestore",
    "predeploy": "npm run --silent _functionsNpmInstall && tools/hack.sh 1",
    "postdeploy": "tools/hack.sh 2",
    " -- -": "",
    "_functionsNpmInstall": "(cd functions && npm install)",
    "//pretest, prestart, predeploy": "tbd. Test that 'firebase' version >= 9.4.0 (has a fix for deploying with Node 15)",
    "//predeploy": "npm run --silent _checkFirebaseActiveProj",
    "//_checkFirebaseActiveProj": "[[ $(firebase use | cat) != *\"No active project\"* ]] || ( >&2 echo \"ERROR: No active project. Please run 'firebase use <alias>' or 'firebase use --add'.\n\"; exit 1)"
  },
  "devDependencies": {
    "concurrently": "^6.0.0",
    "eslint-plugin-node": "^11.1.0",
    "firebase-admin": "^9.5.0",
    "jest": "^27.0.0-next.3",
    "jest-circus": "^27.0.0-next.3",
    "wait-on": "^5.2.1"
  },
  "//devDependencies": {
    "//@local/functions": "file:functions"
  },
  "//comments": {
    "engines.node": [
      "'>=14.3' for 'â€”harmony-top-level-await'",
      "'>=13.2' for ES module support"
    ],
    "scripts": {
      "//preinstall": [
        "There does not seem to exist a need for '(cd functions && npm install)', now that we depend on 'file:functions'",
        "Keep an eye on it. If needed, a 'preinstall' script can be used to create 'functions/node_modules'."
      ]
    }
  }
}
