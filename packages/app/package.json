{
  "name": "@local/app",
  "description": "Sample front end (host)",
  "license": "MIT",
  "private": true,
  "author": "<akauppi@gmail.com>",
  "type": "module",
  "engines": {
    "node": ">=16.6.1"
  },
  "scripts": {
    "dev": "npm run dev:local",
    "-- ": "",
    "test": "npm run -s _emulRunning && npm run -s _testDC && npm run -s _testRun",
    "_testDC": "PORT=3003 docker compose -f docker-compose.test.yml run --rm vite-for-test-launched",
    "_testRun": "CYPRESS_defaultCommandTimeout=10000 CYPRESS_baseUrl=http://localhost:3003 cypress run",
    "-- -": "",
    "dev:local": "npm run -s _checkNoEsbuild && npm run -s _touchDevLocalEnv && npm run -s _emulPrimed && PORT=3000 docker compose -f docker-compose.local.yml run --rm --service-ports vite-dev",
    "_touchDevLocalEnv": "touch .env.dev_local",
    "_emulRunning": "(cd ../backend && npm run app:start)",
    "_emulPrimed": "npm run -s _emulRunning && npm run -s _prime",
    "_prime": "docker compose -f docker-compose.tools.local.yml run --rm prime",
    "--  -": "",
    "ci:launch": "vite --mode dev_local",
    "-- --": "",
    "dev:online": "npm run -s _checkStaging && npm run -s _checkNoEsbuild && npm run -s _touchDevOnlineEnv && PORT=3001 docker compose -f docker-compose.online.yml run --rm --service-ports vite-online",
    "_touchDevOnlineEnv": "touch .env.dev_online",
    "--   -": "",
    "lint": "eslint --ext .js,.vue src || true",
    "-- - -": "",
    "build": "npm run -s _checkNoEsbuild && npm run -s _touchProdEnv && npm run -s _touchStats && RELEASE=manual docker compose -f docker-compose.tools.prod.yml run --rm build",
    "_touchProdEnv": "touch .env.${ENV:-staging}",
    "_touchStats": "touch stats.html",
    "serve": "http-server -p 8080 dist",
    "//serve": "docker compose run --rm --service-ports _serve",
    "--  --": "",
    "_build:dev": "npm run -s _touchDevLocalEnv && docker compose -f docker-compose.local.yml run --rm build",
    "--  -- ": "",
    "_checkStaging": "[ -f ../../firebase.${ENV-staging}.js ] || ( >&2 echo \"ERROR: '../../firebase.${ENV-staging}.js' is missing; see 'README.md' on how to create one.\n\"; false)",
    "_checkNoEsbuild": "[ ! -d node_modules/esbuild ] || ( >&2 echo \"INTERNAL ERROR: 'node_modules/esbuild*' shouldn't be there; please remove them. (rm -rf node_modules/esbuild*)\"; false) ",
    "-- ---": "",
    "postinstall": "if [ -z $BUILDER_OUTPUT ]; then npm run -s _postinstall_dev ; else npm run -s _postinstall_ci ; fi",
    "_postinstall_dev": "(cd node_modules && rm -rf vite rollup esbuild esbuild-*)",
    "_postinstall_ci": "npm run -s _genEnvCi && touch stats.html",
    "_genEnvCi": "EMUL_HOST=emul-for-app tools/gen-vite-env-local.js --project=demo-main > .env",
    "--    -": "",
    "_genFirebaseHostingJson": "node --input-type=module -e \"import o from './firebase.hosting.js'; console.log(JSON.stringify(o, null, 2));\" > tmp/firebase.hosting.json",
    "-- -  -": "",
    "predev:local": "make refresh-vite-dev refresh-prime",
    "predev:online": "make refresh-vite-online",
    "pretest": "make refresh-vite-dev",
    "prebuild": "make refresh-build"
  },
  "dependencies": {
    "@sentry/browser": "^7.0.0",
    "@sentry/tracing": "^7.0.0",
    "aside-keys": "^0.0.3-alpha.1",
    "@firebase/app": "^0.7.28",
    "@firebase/database": "^0.13.3",
    "@firebase/firestore": "^3.4.12",
    "@firebase/performance": "^0.5.12",
    "plausible-tracker": "^0.3.5",
    "vue": "^3.2.37",
    "vue-router": "^4.1.2"
  },
  "devDependencies": {
    "@vitejs/plugin-vue": "^2.3.3",
    "cypress": "10.3.0",
    "sass": "^1.53.0",
    "prettier": "2.7.1"
  },
  "//comments": {
    "devDependencies": {
      "cypress": [
        "Using specific version (not '^') to reduce the number of binaries downloaded (600MB+ each): du -d 1 -h ~/Library/Caches/Cypress/"
      ],
      "prettier": [
        "> when Prettier is installed or updated, itâ€™s strongly recommended to specify the exact version in package.json: \"2.3.0\", not \"^2.3.0\".",
        "Thus, following suit."
      ],
      "sass": [
        "Needed for 'lang=scss' to work, in Vue.",
        "",
        "Note: Vue docs [1] display 'sass-loader' and 'node-sass', but the latter's npm page [2] says it's deprecated.",
        "",
        "[1]: https://vue-loader.vuejs.org/guide/pre-processors.html#sass",
        "[2]: https://www.npmjs.com/package/node-sass"
      ]
    },
    "engines.node": [
      ">= 16.6.1: because of -> https://github.com/facebook/jest/issues/11708"
    ],
    "scripts": {
      "CYPRESS_defaultCommandTimeout": [
        "When cold-starting DC with 'npm test' on macOS, the 2nd test has been seen to take over 8s (default timeout",
        "is 4s)."
      ],
      "[ -z $BUILDER_OUTPUT ]": [
        "Separates commands to be run in CI."
      ],
      "build": [
        "Only for manual builds. CI runs DC, directly."
      ],
      "_prime": [
        "The project name used _must_ match that in '../backend/', used for launching the emulators."
      ],
      "_touchEm": [
        "Vital for DC that files to be mapped to the container exist *before* the DC command."
      ],
      "_refresh": [
        "Run this once you've changed anything in 'tools/*.dc' - i.e. the Vite version."
      ]
    }
  }
}
